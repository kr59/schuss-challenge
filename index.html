<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>ğŸ¯ Schussduell</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Outfit:wght@300;400;500;600;700;800&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BASE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
html,body{height:100%;overflow:hidden}
body{
  height:100%;
  background:#0e1208;
  font-family:'Outfit',sans-serif;
  font-size:16px;
  display:flex;flex-direction:column;align-items:center;
  overflow:hidden;
  color:#e8e8e0;
}

/* Layered background */
body::before{
  content:'';position:fixed;inset:0;z-index:0;
  background:
    radial-gradient(ellipse 80% 60% at 50% -10%, rgba(90,140,30,.18) 0%, transparent 60%),
    radial-gradient(ellipse 60% 40% at 80% 100%, rgba(40,60,15,.25) 0%, transparent 50%),
    linear-gradient(175deg, #0a0f06 0%, #111808 40%, #0e1408 100%);
}
/* Grain overlay */
body::after{
  content:'';position:fixed;inset:0;z-index:0;pointer-events:none;
  background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
  background-size:180px 180px;
  opacity:0.6;
}

.screen{display:none;flex-direction:column;align-items:center;width:100%;height:100%;position:relative;z-index:1;overflow-y:auto;overflow-x:hidden;}
.screen.active{display:flex;}
::-webkit-scrollbar{width:2px;}::-webkit-scrollbar-thumb{background:#2a4010;border-radius:2px;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HEADER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.hdr{
  width:100%;flex-shrink:0;
  padding:14px 20px 0;
  background:linear-gradient(180deg,rgba(8,14,4,.97) 0%,rgba(12,18,6,.92) 100%);
  border-bottom:1px solid rgba(100,160,40,.2);
  display:flex;flex-direction:column;align-items:center;
  position:relative;
}
.hdr::after{
  content:'';position:absolute;bottom:-1px;left:0;right:0;height:1px;
  background:linear-gradient(90deg,transparent,rgba(140,200,60,.35) 30%,rgba(140,200,60,.35) 70%,transparent);
}
.logo{
  font-family:'Bebas Neue',cursive;
  font-size:clamp(2rem,8vw,2.8rem);
  letter-spacing:.16em;
  color:#f0e0a0;
  text-shadow:0 2px 12px rgba(0,0,0,.9), 0 0 30px rgba(200,170,60,.15);
  line-height:1;
}
.logo em{color:#8ecf40;font-style:normal;}
.logo-tag{
  font-size:.6rem;letter-spacing:.4em;text-transform:uppercase;
  color:rgba(140,200,60,.55);
  margin-top:2px;font-weight:500;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HEADER TOP ROW  (streak left Â· logo center)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.hdr-top{
  width:100%;display:flex;align-items:center;justify-content:space-between;
  padding:0 2px;margin-bottom:4px;
}
.streak-corner{
  display:flex;align-items:center;gap:5px;
  background:rgba(170,90,255,.1);
  border:1px solid rgba(170,90,255,.2);
  border-radius:8px;
  padding:4px 9px 4px 7px;
  cursor:default;
  transition:background .2s;
  flex-shrink:0;
}
.streak-corner:hover{background:rgba(170,90,255,.16);}
.sc-fire{font-size:.85rem;line-height:1;}
.sc-inf{display:flex;flex-direction:column;}
.sc-n{
  font-family:'Bebas Neue',cursive;
  font-size:1rem;line-height:1;
  color:#c880ff;
  text-shadow:0 0 10px rgba(180,90,255,.35);
}
.sc-lbl{
  font-size:.38rem;letter-spacing:.16em;text-transform:uppercase;
  color:rgba(190,140,255,.35);font-weight:600;line-height:1;margin-top:1px;
}
/* mirrors streak width so logo stays centered */
.hdr-spacer{flex-shrink:0;visibility:hidden;pointer-events:none;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   WEAPON TABS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.weapon-tabs{
  display:flex;width:100%;margin-top:12px;
  border-bottom:1px solid rgba(255,255,255,.08);
}
.weapon-tab{
  flex:1;
  display:flex;flex-direction:column;align-items:center;
  padding:10px 8px 11px;
  cursor:pointer;
  position:relative;
  transition:background .18s;
  -webkit-tap-highlight-color:transparent;
}
.weapon-tab:active{background:rgba(255,255,255,.03);}
.weapon-tab::after{
  content:'';
  position:absolute;bottom:-1px;left:16%;right:16%;
  height:3px;
  background:#8ecf40;
  border-radius:3px 3px 0 0;
  transform:scaleX(0);
  transition:transform .22s cubic-bezier(.34,1.56,.64,1);
}
.weapon-tab.active::after{transform:scaleX(1);}
.wt-name{
  font-size:.88rem;font-weight:700;letter-spacing:.07em;text-transform:uppercase;
  color:rgba(255,255,255,.32);
  transition:color .2s;
  line-height:1;
}
.weapon-tab.active .wt-name{color:#c8ee80;}

/* Separator line between tabs */
.weapon-tabs .weapon-tab:not(:last-child){
  border-right:1px solid rgba(255,255,255,.06);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STAT CHIPS IN HEADER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.hdr-chips{display:flex;gap:8px;margin-top:10px;width:100%;max-width:400px;justify-content:center;}
.chip{
  display:flex;flex-direction:column;align-items:center;
  background:rgba(0,0,0,.45);
  border:1px solid rgba(255,255,255,.07);
  border-radius:10px;
  padding:6px 14px;
  min-width:76px;
}
.chip.green{border-color:rgba(100,180,40,.25);background:rgba(60,120,10,.2);}
.chip.red  {border-color:rgba(180,60,40,.25); background:rgba(100,20,10,.2);}
.chip.gold {border-color:rgba(180,140,20,.25);background:rgba(100,70,5,.2);}
.chip-label{font-size:.52rem;letter-spacing:.2em;text-transform:uppercase;color:rgba(255,255,255,.3);font-weight:600;}
.chip-val{font-family:'Bebas Neue',cursive;font-size:1.7rem;line-height:1.1;color:#f0e0a0;}
.chip-sub{font-size:.45rem;letter-spacing:.12em;text-transform:uppercase;color:rgba(255,255,255,.2);}
.chip.gold .chip-val{color:#ffc840;}
.chip.green .chip-val{color:#a8e060;}
.chip.red .chip-val{color:#f08070;}
@keyframes pulse{from{opacity:1}to{opacity:.45}}
.chip-val.low{color:#ff5030!important;animation:pulse .6s ease infinite alternate;}

.hdr-tag{
  font-size:.5rem;letter-spacing:.28em;text-transform:uppercase;
  color:rgba(140,200,60,.6);
  background:rgba(100,160,30,.08);
  border:1px solid rgba(100,160,30,.18);
  border-radius:4px;padding:3px 12px;margin:8px 0 10px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   COMMON CARDS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.content{flex:1;display:flex;flex-direction:column;align-items:center;width:100%;max-width:420px;padding:16px 18px;gap:13px;}
.card{width:100%;background:rgba(0,0,0,.5);border:1px solid rgba(255,255,255,.07);border-radius:14px;padding:14px 16px;}
.card-hd{
  font-size:.55rem;letter-spacing:.3em;text-transform:uppercase;
  color:rgba(255,255,255,.28);font-weight:600;margin-bottom:12px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SHOT COUNT SELECTOR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.sc-row{display:flex;gap:8px;}
.scb{
  flex:1;padding:11px 4px;
  background:rgba(255,255,255,.03);
  border:1px solid rgba(255,255,255,.09);
  border-radius:10px;cursor:pointer;transition:all .18s;
  display:flex;flex-direction:column;align-items:center;gap:2px;
}
.scb-n{font-family:'Bebas Neue',cursive;font-size:1.6rem;color:rgba(255,255,255,.55);line-height:1;}
.scb-u{font-size:.46rem;letter-spacing:.18em;text-transform:uppercase;color:rgba(255,255,255,.2);}
.scb.active{background:rgba(110,170,40,.14);border-color:#6aaa28;box-shadow:0 0 14px rgba(110,170,40,.15);}
.scb.active .scb-n{color:#c8ee80;}
.scb.active .scb-u{color:rgba(160,220,80,.5);}

/* 5-shot burst button */
.btn-burst{
  width:100%;padding:11px 16px;
  font-family:'Outfit',sans-serif;font-size:.88rem;font-weight:700;letter-spacing:.05em;
  color:rgba(120,200,255,.7);
  background:rgba(40,100,200,.06);
  border:1px solid rgba(80,150,255,.2);
  border-radius:10px;cursor:pointer;transition:all .2s;
  display:flex;align-items:center;justify-content:center;gap:8px;
}
.btn-burst.on{
  color:#70c8ff;
  background:rgba(40,120,220,.15);
  border-color:rgba(80,160,255,.4);
  box-shadow:0 0 12px rgba(80,160,255,.12);
}
.btn-burst:active{background:rgba(40,100,200,.18);}
.burst-badge{
  font-size:.52rem;letter-spacing:.18em;text-transform:uppercase;
  padding:1px 6px;border-radius:3px;
  background:rgba(80,160,255,.15);border:1px solid rgba(80,160,255,.3);
  color:rgba(120,190,255,.7);font-weight:700;
}
.dist-row{display:flex;gap:8px;}
.db{
  flex:1;padding:13px 4px;
  background:rgba(255,255,255,.03);
  border:1px solid rgba(255,255,255,.09);
  border-radius:10px;
  cursor:pointer;transition:all .18s;
  display:flex;flex-direction:column;align-items:center;gap:3px;
}
.db.hidden{display:none;}
.db-n{font-family:'Bebas Neue',cursive;font-size:1.6rem;color:rgba(255,255,255,.55);line-height:1;}
.db-u{font-size:.48rem;letter-spacing:.2em;text-transform:uppercase;color:rgba(255,255,255,.22);}
.db.active{background:rgba(110,170,40,.14);border-color:#6aaa28;box-shadow:0 0 14px rgba(110,170,40,.15);}
.db.active .db-n{color:#c8ee80;}
.db.active .db-u{color:rgba(160,220,80,.5);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INFO / HINT STRIPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.info-row{display:flex;align-items:flex-start;gap:10px;padding:10px 14px;background:rgba(20,40,80,.25);border:1px solid rgba(80,130,200,.15);border-radius:10px;width:100%;}
.info-ico{font-size:1.1rem;margin-top:1px;flex-shrink:0;}
.info-txt{font-size:.85rem;color:rgba(180,205,240,.55);line-height:1.45;font-weight:400;}
.info-txt b{color:rgba(200,225,255,.75);font-weight:600;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DIFFICULTY BUTTONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.diff-row{display:flex;gap:8px;}
.dif{
  flex:1;padding:13px 6px;
  background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.08);
  border-radius:10px;cursor:pointer;transition:all .2s;
  display:flex;flex-direction:column;align-items:center;gap:4px;
}
.dif-ico{font-size:1.4rem;line-height:1;}
.dif-name{font-size:.82rem;font-weight:700;color:rgba(255,255,255,.45);letter-spacing:.04em;}
.dif-desc{font-size:.5rem;letter-spacing:.12em;text-transform:uppercase;color:rgba(255,255,255,.2);}
.dif.easy{border-color:rgba(80,180,80,.15);}
.dif.easy.active{background:rgba(50,140,50,.16);border-color:#46b040;box-shadow:0 0 14px rgba(70,176,64,.15);}
.dif.easy.active .dif-name{color:#80d860;}
.dif.real{border-color:rgba(80,130,220,.15);}
.dif.real.active{background:rgba(50,100,200,.14);border-color:#4882d8;box-shadow:0 0 14px rgba(72,130,216,.15);}
.dif.real.active .dif-name{color:#70aaf0;}
.dif.hard{border-color:rgba(200,60,40,.15);}
.dif.hard.active{background:rgba(180,35,25,.16);border-color:#c82818;box-shadow:0 0 14px rgba(200,40,24,.18);}
.dif.hard.active .dif-name{color:#f07060;}
.dif.elite{border-color:rgba(220,170,20,.15);}
.dif.elite.active{
  background:linear-gradient(135deg,rgba(120,80,0,.25),rgba(80,50,0,.2));
  border-color:#d4a820;
  box-shadow:0 0 18px rgba(212,168,32,.25),inset 0 0 12px rgba(212,168,32,.06);
}
.dif.elite.active .dif-name{color:#f0c840;}
.dif.elite.active .dif-ico{filter:drop-shadow(0 0 4px rgba(255,210,50,.6));}

/* Diff badge */
.diff-badge{
  display:inline-flex;align-items:center;gap:5px;
  font-size:.52rem;letter-spacing:.22em;text-transform:uppercase;
  border-radius:5px;padding:2px 10px;margin-top:5px;border:1px solid;font-weight:600;
}
.diff-badge.easy{color:#80d860;border-color:rgba(128,216,96,.3);background:rgba(70,176,64,.08);}
.diff-badge.real{color:#70aaf0;border-color:rgba(112,170,240,.3);background:rgba(72,130,216,.08);}
.diff-badge.hard{color:#f07060;border-color:rgba(240,112,96,.3);background:rgba(200,40,24,.08);}
.diff-badge.elite{
  color:#f0c840;border-color:rgba(240,200,64,.4);
  background:rgba(160,110,0,.15);
  box-shadow:0 0 8px rgba(240,200,64,.15);
}

/* Weapon badge in battle header */
.weapon-badge{
  display:inline-flex;align-items:center;gap:4px;
  font-size:.5rem;letter-spacing:.2em;text-transform:uppercase;
  border-radius:4px;padding:2px 9px;margin-top:3px;border:1px solid;font-weight:700;
}
.weapon-badge.lg{color:#70d8f8;border-color:rgba(112,216,248,.3);background:rgba(40,140,200,.08);}
.weapon-badge.kk{color:#f8c870;border-color:rgba(248,200,112,.3);background:rgba(160,100,20,.08);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ACTION BUTTONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.actions{width:100%;max-width:420px;padding:0 18px 18px;display:flex;flex-direction:column;gap:9px;flex-shrink:0;}

.btn-fire{
  width:100%;padding:18px 20px;
  font-family:'Bebas Neue',cursive;font-size:2.2rem;letter-spacing:.2em;
  color:#0c1008;
  background:linear-gradient(175deg,#dab228 0%,#a07c10 48%,#c8981c 100%);
  border:none;border-radius:13px;cursor:pointer;
  position:relative;overflow:hidden;
  box-shadow:0 5px 0 #5a3c08,0 8px 24px rgba(180,140,0,.25),inset 0 1px 0 rgba(255,255,255,.3);
  transition:transform .1s,box-shadow .1s;
  display:flex;align-items:center;justify-content:center;gap:10px;
  will-change:transform;
}
.btn-fire::after{content:'';position:absolute;top:0;left:0;right:0;height:46%;background:rgba(255,255,255,.15);border-radius:11px 11px 50% 50%;}
.btn-fire:active{transform:translateY(4px);box-shadow:0 1px 0 #5a3c08,0 3px 8px rgba(180,140,0,.15),inset 0 1px 0 rgba(255,255,255,.3);}
.btn-fire:disabled{background:linear-gradient(180deg,#282828,#1a1a1a);color:rgba(255,255,255,.2);box-shadow:0 3px 0 #111;cursor:not-allowed;}

.btn-sec{
  width:100%;padding:12px 16px;
  font-family:'Outfit',sans-serif;font-size:.9rem;font-weight:600;letter-spacing:.06em;
  color:rgba(255,100,80,.55);
  background:rgba(255,50,30,.04);border:1px solid rgba(255,50,30,.16);
  border-radius:10px;cursor:pointer;transition:all .2s;
}
.btn-sec:active{background:rgba(255,50,30,.1);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BATTLE SCREEN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#screenBattle .content{padding:10px 18px;gap:9px;}

.target-wrap{position:relative;flex-shrink:0;width:100%;display:flex;justify-content:center;}
.target-shadow{position:absolute;bottom:-10px;left:50%;transform:translateX(-50%);width:80%;height:18px;background:radial-gradient(ellipse,rgba(0,0,0,.6) 0%,transparent 75%);filter:blur(6px);}
#targetCanvas{display:block;border-radius:50%;box-shadow:0 0 0 1px rgba(180,160,100,.25),0 12px 40px rgba(0,0,0,.6);will-change:transform;}

/* Live dual-score bar */
.live-score-bar{
  width:100%;
  background:rgba(0,0,0,.5);
  border:1px solid rgba(180,55,40,.22);
  border-radius:12px;
  padding:10px 16px;
  display:flex;align-items:center;justify-content:space-between;gap:8px;
}
.lsb-block{display:flex;flex-direction:column;align-items:center;flex:1;}
.lsb-lbl{font-size:.48rem;letter-spacing:.22em;text-transform:uppercase;color:rgba(255,255,255,.28);font-weight:600;margin-bottom:2px;}
.lsb-val{font-family:'DM Mono',monospace;font-size:1.55rem;font-weight:500;line-height:1;}
.lsb-val.dec{color:#f08070;}
.lsb-val.int{color:rgba(240,130,110,.5);}
.lsb-val.proj{color:rgba(255,200,80,.45);font-size:1.1rem;}
.lsb-divider{width:1px;height:32px;background:rgba(255,255,255,.08);flex-shrink:0;}

/* Shot progress bar */
.shot-progress{width:100%;display:flex;flex-direction:column;gap:5px;}
.sp-row{display:flex;align-items:center;justify-content:space-between;}
.sp-lbl{font-size:.5rem;letter-spacing:.2em;text-transform:uppercase;color:rgba(255,195,60,.38);font-weight:600;}
.sp-count{font-family:'DM Mono',monospace;font-size:.9rem;color:#ffc840;}
.sp-count.low{color:#ff5030;}
.sp-bar{width:100%;height:6px;background:rgba(255,255,255,.07);border-radius:3px;overflow:hidden;}
.sp-fill{height:100%;border-radius:3px;transition:width .2s ease,background .3s;background:linear-gradient(90deg,#5a9020,#a0d030);will-change:width;}
.sp-fill.low{background:linear-gradient(90deg,#8a1010,#e04040);}

/* Mini shot log */
.shot-log{width:100%;display:flex;gap:4px;flex-wrap:wrap;min-height:22px;}
.sl-pill{
  font-family:'DM Mono',monospace;font-size:.65rem;font-weight:500;
  padding:2px 6px;border-radius:4px;border:1px solid;
  animation:fadeUp .2s ease forwards;
}
.sl-pill.x  {color:#ffd040;border-color:rgba(255,208,64,.4);background:rgba(255,208,64,.1);}
.sl-pill.hi {color:#a0e060;border-color:rgba(160,224,96,.3);background:rgba(100,180,40,.1);}
.sl-pill.mid{color:#70aaf0;border-color:rgba(112,170,240,.25);background:rgba(70,120,200,.1);}
.sl-pill.lo {color:rgba(255,255,255,.4);border-color:rgba(255,255,255,.1);background:rgba(255,255,255,.04);}
.sl-pill.miss{color:rgba(255,100,80,.5);border-color:rgba(255,80,60,.2);background:rgba(255,50,30,.06);}

/* Last shot info box */
.last-shot-box{
  width:100%;padding:9px 13px;
  background:rgba(0,0,0,.38);border:1px solid rgba(255,255,255,.07);
  border-radius:10px;
}
.ls-txt{font-size:.86rem;color:rgba(180,210,240,.5);line-height:1.4;}
.ls-txt b{color:rgba(200,225,255,.75);font-weight:700;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ENTRY SCREEN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#screenEntry{justify-content:flex-start;}
#screenEntry .content{padding:14px 18px;gap:13px;}

.bot-result{
  width:100%;
  background:linear-gradient(135deg,rgba(40,5,5,.7),rgba(25,0,0,.8));
  border:1px solid rgba(180,50,40,.3);
  border-radius:14px;padding:16px;
  text-align:center;
  position:relative;overflow:hidden;
}
.bot-result::before{
  content:'';position:absolute;inset:0;
  background:radial-gradient(ellipse 70% 50% at 50% 100%,rgba(180,40,30,.12) 0%,transparent 70%);
  pointer-events:none;
}
.br-lbl{font-size:.55rem;letter-spacing:.3em;text-transform:uppercase;color:rgba(240,110,90,.45);font-weight:600;margin-bottom:6px;}
.br-pts{
  font-family:'Bebas Neue',cursive;font-size:3.2rem;color:#f08070;line-height:1;
  text-shadow:0 0 24px rgba(240,100,80,.35);
}
.br-sub{font-size:.78rem;color:rgba(255,255,255,.28);margin-top:4px;font-weight:400;}

.entry-card2{width:100%;background:rgba(0,0,0,.48);border:1px solid rgba(110,170,40,.2);border-radius:14px;padding:15px;}
.ec-lbl{font-size:.55rem;letter-spacing:.28em;text-transform:uppercase;color:rgba(255,255,255,.25);font-weight:600;margin-bottom:12px;}
.ec-row{display:flex;gap:8px;align-items:stretch;}
.score-inp{
  flex:1;
  padding:13px 14px;
  font-family:'DM Mono',monospace;font-size:1.9rem;font-weight:500;letter-spacing:.05em;
  background:rgba(255,255,255,.05);border:1px solid rgba(110,170,40,.28);
  border-radius:9px;color:#b8e870;outline:none;text-align:center;
  -webkit-appearance:none;-moz-appearance:textfield;
  transition:border-color .2s,box-shadow .2s;
}
.score-inp:focus{border-color:#7ab030;box-shadow:0 0 14px rgba(120,180,40,.18);}
.score-inp::placeholder{color:rgba(255,255,255,.15);}
.btn-calc{
  padding:13px 16px;
  font-family:'Outfit',sans-serif;font-weight:700;font-size:.9rem;letter-spacing:.05em;
  background:linear-gradient(135deg,#5a9020,#3a6010);
  color:#d8f8a0;border:none;border-radius:9px;cursor:pointer;
  box-shadow:0 3px 0 #1a3008;transition:transform .1s,box-shadow .1s;
  white-space:nowrap;
}
.btn-calc:active{transform:translateY(2px);box-shadow:0 1px 0 #1a3008;}

/* Auto-calc Ganze hint */
.auto-int{
  margin-top:7px;font-size:.78rem;color:rgba(200,255,150,.35);
  font-family:'DM Mono',monospace;letter-spacing:.04em;
  transition:color .2s;
}
.auto-int.active{color:rgba(200,255,150,.65);}
.auto-int span{font-weight:700;color:#a0e060;}

.divider{width:100%;display:flex;align-items:center;gap:10px;}
.divider-line{flex:1;height:1px;background:rgba(255,255,255,.08);}
.divider-txt{font-size:.58rem;letter-spacing:.22em;text-transform:uppercase;color:rgba(255,255,255,.18);font-weight:600;}

.quick-pair{width:100%;display:flex;gap:9px;}
.btn-win{
  flex:1;padding:16px 8px;
  font-family:'Outfit',sans-serif;font-size:1rem;font-weight:800;letter-spacing:.04em;
  color:#0a1206;
  background:linear-gradient(175deg,#90d838,#5a9c18);
  border:none;border-radius:12px;cursor:pointer;
  box-shadow:0 4px 0 #245008,0 6px 18px rgba(100,190,30,.22),inset 0 1px 0 rgba(255,255,255,.25);
  transition:transform .1s,box-shadow .1s;
  display:flex;flex-direction:column;align-items:center;gap:3px;
}
.btn-win:active{transform:translateY(3px);box-shadow:0 1px 0 #245008;}
.btn-lose{
  flex:1;padding:16px 8px;
  font-family:'Outfit',sans-serif;font-size:1rem;font-weight:800;letter-spacing:.04em;
  color:#fff0ee;
  background:linear-gradient(175deg,#982820,#621410);
  border:none;border-radius:12px;cursor:pointer;
  box-shadow:0 4px 0 #240808,0 6px 18px rgba(160,35,25,.22),inset 0 1px 0 rgba(255,255,255,.12);
  transition:transform .1s,box-shadow .1s;
  display:flex;flex-direction:column;align-items:center;gap:3px;
}
.btn-lose:active{transform:translateY(3px);box-shadow:0 1px 0 #240808;}
.qb-ico{font-size:1.5rem;line-height:1;}
.qb-main{font-size:1rem;font-weight:800;letter-spacing:.03em;}
.qb-sub{font-size:.62rem;opacity:.5;font-weight:500;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GAME OVER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#screenOver{justify-content:center;gap:16px;text-align:center;padding:28px 22px;overflow-y:auto;}
.go-emoji{font-size:4.5rem;line-height:1;}
.go-title{
  font-family:'Bebas Neue',cursive;
  font-size:clamp(2.8rem,12vw,4.5rem);letter-spacing:.1em;line-height:1;
}
.go-title.win {color:#90d838;text-shadow:0 0 32px rgba(144,216,56,.35);}
.go-title.lose{color:#f06050;text-shadow:0 0 32px rgba(240,96,80,.35);}
.go-title.draw{color:#f0c838;text-shadow:0 0 32px rgba(240,200,56,.35);}
.go-sub{color:rgba(255,255,255,.4);font-size:1rem;max-width:280px;line-height:1.45;font-weight:400;}
.go-scores{
  display:flex;align-items:stretch;gap:0;
  background:rgba(0,0,0,.48);border:1px solid rgba(255,255,255,.08);
  border-radius:16px;overflow:hidden;
}
.gs-block{display:flex;flex-direction:column;align-items:center;gap:3px;padding:16px 28px;}
.gs-block:first-child{border-right:1px solid rgba(255,255,255,.07);}
.gs-who{font-size:.52rem;letter-spacing:.22em;text-transform:uppercase;color:rgba(255,255,255,.28);font-weight:600;}
.gs-num{font-family:'DM Mono',monospace;font-size:2.8rem;font-weight:500;line-height:1;}
.gs-num.you{color:#b0e870;}.gs-num.bot{color:#f08070;}
.gs-unit{font-size:.6rem;color:rgba(255,255,255,.25);letter-spacing:.15em;text-transform:uppercase;font-weight:500;}
.gs-sep{
  display:flex;align-items:center;justify-content:center;padding:0 4px;
  font-family:'Bebas Neue',cursive;font-size:1.6rem;color:rgba(255,255,255,.12);
  background:rgba(0,0,0,.3);
}
.go-reason{font-size:.62rem;color:rgba(255,255,255,.2);letter-spacing:.18em;text-transform:uppercase;font-weight:500;}
.go-margin{
  font-size:.82rem;font-weight:600;letter-spacing:.04em;
  padding:5px 16px;border-radius:20px;border:1px solid;
}
.go-margin.win {color:#90d838;border-color:rgba(144,216,56,.3);background:rgba(100,200,40,.08);}
.go-margin.lose{color:#f06050;border-color:rgba(240,96,80,.3);background:rgba(200,60,40,.08);}
.go-margin.draw{color:#f0c838;border-color:rgba(240,200,56,.3);background:rgba(200,160,40,.08);}

/* Dual score display */
.dual-score{display:flex;align-items:baseline;justify-content:center;gap:10px;flex-wrap:wrap;}
.ds-main{font-family:'DM Mono',monospace;font-size:2.8rem;font-weight:500;line-height:1;}
.ds-sep{font-size:1rem;color:rgba(255,255,255,.2);font-weight:300;}
.ds-int{font-family:'DM Mono',monospace;font-size:1.6rem;font-weight:400;color:rgba(255,255,255,.38);line-height:1;}
.ds-int-lbl{font-size:.5rem;letter-spacing:.18em;text-transform:uppercase;color:rgba(255,255,255,.22);display:block;text-align:center;margin-top:1px;}
.ds-dec-lbl{font-size:.5rem;letter-spacing:.18em;text-transform:uppercase;display:block;text-align:center;margin-top:1px;}
.dual-wrap{display:flex;align-items:center;justify-content:center;gap:16px;}
.dual-col{display:flex;flex-direction:column;align-items:center;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FX
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#muzzleFlash{position:fixed;inset:0;background:radial-gradient(ellipse at center,rgba(255,240,120,.95) 0%,rgba(255,120,0,.35) 42%,transparent 65%);z-index:999;pointer-events:none;opacity:0;will-change:opacity;}
@keyframes camShake{
  0%{transform:translate(0,0) rotate(0)}
  12%{transform:translate(-5px,4px) rotate(-.6deg)}
  30%{transform:translate(5px,-3px) rotate(.5deg)}
  52%{transform:translate(-3px,4px) rotate(-.35deg)}
  78%{transform:translate(3px,-1px) rotate(.2deg)}
  100%{transform:translate(0,0) rotate(0)}
}
.shaking{animation:camShake .32s ease;will-change:transform;}
@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
.fade-up{animation:fadeUp .38s ease forwards;}
@keyframes popIn{from{opacity:0;transform:scale(.88)}to{opacity:1;transform:scale(1)}}
.pop-in{animation:popIn .3s cubic-bezier(.34,1.56,.64,1) forwards;}
.x-hit{color:#ffd040;text-shadow:0 0 8px rgba(255,210,0,.5);}

/* streak new badge */
.streak-new{
  display:inline-block;font-size:.5rem;letter-spacing:.18em;text-transform:uppercase;
  background:rgba(180,90,255,.2);border:1px solid rgba(180,90,255,.4);
  border-radius:3px;padding:1px 6px;color:#e0b0ff;margin-left:6px;
  animation:fadeUp .4s ease forwards;
}
</style>
</head>
<body>
<div id="muzzleFlash"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SETUP â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="screenSetup" class="screen active">
  <div class="hdr">
    <!-- Top row: streak left Â· logo center Â· spacer right -->
    <div class="hdr-top">
      <div class="streak-corner" id="streakCorner">
        <span class="sc-fire" id="scFire">ğŸ”¥</span>
        <div class="sc-inf">
          <div class="sc-n" id="scN">â€“</div>
          <div class="sc-lbl" id="scLbl">Streak</div>
        </div>
      </div>
      <div class="logo">SCHUSS<em>DUELL</em></div>
      <div class="hdr-spacer" aria-hidden="true">
        <div class="streak-corner" style="visibility:hidden;">
          <span class="sc-fire">ğŸ”¥</span>
          <div class="sc-inf"><div class="sc-n">0</div><div class="sc-lbl">x</div></div>
        </div>
      </div>
    </div>
    <div class="logo-tag" id="logoTag">Du vs. Bot Â· 40 Schuss Â· Wer trifft besser?</div>

    <!-- Weapon Tabs -->
    <div class="weapon-tabs" id="weaponTabs">
      <div class="weapon-tab active" id="wTabLG" onclick="switchWeapon('lg')">
        <div class="wt-name">ğŸŒ¬ï¸ Luftgewehr</div>
      </div>
      <div class="weapon-tab" id="wTabKK" onclick="switchWeapon('kk')">
        <div class="wt-name">ğŸ¯ KK</div>
      </div>
    </div>

    <div class="hdr-tag" id="setupTag">â—† LUFTGEWEHR Â· 10 METER â—†</div>
  </div>

  <div class="content">
    <!-- Distanz -->
    <div class="card">
      <div class="card-hd">â—ˆ Distanz zur Scheibe</div>
      <div class="dist-row" id="distGroup">
        <button class="db active" data-dist="10" onclick="selDist(this)">
          <span class="db-n">10</span><span class="db-u">Meter</span>
        </button>
        <button class="db" data-dist="25" onclick="selDist(this)">
          <span class="db-n">25</span><span class="db-u">Meter</span>
        </button>
        <button class="db" data-dist="50" onclick="selDist(this)">
          <span class="db-n">50</span><span class="db-u">Meter</span>
        </button>
      </div>
    </div>

    <div class="info-row" id="distInfo">
      <span class="info-ico">ğŸ¯</span>
      <span class="info-txt"><b>10 Meter</b> â€“ Luftgewehr-Standarddistanz. HÃ¶chste PrÃ¤zision gefordert.</span>
    </div>

    <!-- Schwierigkeit -->
    <div class="card">
      <div class="card-hd">â—ˆ Bot-Schwierigkeit</div>
      <div class="diff-row" id="diffGroup">
        <button class="dif easy active" data-diff="easy" onclick="selDiff(this)">
          <span class="dif-ico">ğŸ˜Š</span>
          <span class="dif-name">Einfach</span>
          <span class="dif-desc">Kreisklasse</span>
        </button>
        <button class="dif real" data-diff="real" onclick="selDiff(this)">
          <span class="dif-ico">ğŸ¯</span>
          <span class="dif-name">Mittel</span>
          <span class="dif-desc">Bezirksliga</span>
        </button>
        <button class="dif hard" data-diff="hard" onclick="selDiff(this)">
          <span class="dif-ico">ğŸ’€</span>
          <span class="dif-name">Schwer</span>
          <span class="dif-desc">WM-Niveau</span>
        </button>
        <button class="dif elite" data-diff="elite" onclick="selDiff(this)">
          <span class="dif-ico">ğŸ’«</span>
          <span class="dif-name">Elite</span>
          <span class="dif-desc">Weltrekord</span>
        </button>
      </div>
    </div>

    <div class="info-row" id="diffInfo">
      <span class="info-ico">ğŸ˜Š</span>
      <span class="info-txt" id="diffInfoTxt"><b>Kreisklasse</b> â€“ GemÃ¼tlicher Einstieg. Aber unterschÃ¤tz den Bot nicht!</span>
    </div>

    <!-- Schussanzahl -->
    <div class="card">
      <div class="card-hd">â—ˆ Anzahl SchÃ¼sse</div>
      <div class="sc-row" id="shotCountGroup">
        <button class="scb" data-shots="30" onclick="selShots(this)">
          <span class="scb-n">30</span><span class="scb-u">Schuss</span>
        </button>
        <button class="scb active" data-shots="40" onclick="selShots(this)">
          <span class="scb-n">40</span><span class="scb-u">Schuss</span>
        </button>
        <button class="scb" data-shots="60" onclick="selShots(this)">
          <span class="scb-n">60</span><span class="scb-u">Schuss</span>
        </button>
      </div>
    </div>

    <!-- 5er-Salve Option -->
    <button class="btn-burst" id="burstBtn" onclick="toggleBurst()">
      <span id="burstBtnTxt">ğŸ”« 5er-Salve: AUS</span>
      <span class="burst-badge" id="burstBadge">OPTIONAL</span>
    </button>
  </div>

  <div class="actions">
    <button class="btn-fire" onclick="startBattle()">ğŸ¯ &nbsp;DUELL STARTEN</button>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• BATTLE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="screenBattle" class="screen">
  <div class="hdr">
    <div class="logo" style="font-size:1.7rem;letter-spacing:.14em;">SCHUSS<em>DUELL</em></div>
    <div class="hdr-chips">
      <div class="chip gold">
        <div class="chip-label">Ãœbrig</div>
        <div class="chip-val" id="shotsLeft">40</div>
        <div class="chip-sub">Schuss</div>
      </div>
      <div class="chip red" style="flex-direction:row;gap:2px;padding:6px 8px;min-width:unset;">
        <div style="display:flex;flex-direction:column;align-items:center;min-width:52px;">
          <div class="chip-label">Zehntel</div>
          <div class="chip-val" id="botScoreChip" style="font-size:1.25rem;color:#f08070;">0.0</div>
        </div>
        <div style="width:1px;background:rgba(255,255,255,.1);margin:4px 4px;align-self:stretch;"></div>
        <div style="display:flex;flex-direction:column;align-items:center;min-width:48px;">
          <div class="chip-label">Ganze</div>
          <div class="chip-val" id="botScoreChipInt" style="font-size:1.25rem;color:rgba(240,130,110,.5);">0</div>
        </div>
      </div>
    </div>
    <div class="hdr-tag" id="battleTag">â—† SCHUSS 1 / 40 â—†</div>
    <div class="diff-badge easy" id="battleBadge">ğŸ˜Š KREISKLASSE</div>
    <div class="weapon-badge lg" id="battleWeaponBadge" style="margin-bottom:8px;">ğŸŒ¬ï¸ LUFTGEWEHR</div>
  </div>

  <div class="content">
    <div class="target-wrap">
      <canvas id="targetCanvas"></canvas>
      <div class="target-shadow"></div>
    </div>

    <!-- Live dual-score bar -->
    <div class="live-score-bar">
      <div class="lsb-block">
        <div class="lsb-lbl">Bot Zehntel</div>
        <div class="lsb-val dec" id="lsbDec">0.0</div>
      </div>
      <div class="lsb-divider"></div>
      <div class="lsb-block">
        <div class="lsb-lbl">Bot Ganze</div>
        <div class="lsb-val int" id="lsbInt">0</div>
      </div>
      <div class="lsb-divider"></div>
      <div class="lsb-block">
        <div class="lsb-lbl">Hochrechnung</div>
        <div class="lsb-val proj" id="lsbProj">â€“</div>
      </div>
    </div>

    <!-- Mini shot log (last 8) -->
    <div class="shot-log" id="shotLog"></div>

    <!-- Last shot info -->
    <div class="last-shot-box">
      <div class="ls-txt" id="lastShotTxt"><b>Bereit!</b> DrÃ¼ck FEUER â€“ du schieÃŸt in der echten Welt, der Bot virtuell.</div>
    </div>

    <!-- Shot progress -->
    <div class="shot-progress">
      <div class="sp-row">
        <div class="sp-lbl">Fortschritt</div>
        <div class="sp-count" id="spCount">0 / 40 Schuss</div>
      </div>
      <div class="sp-bar"><div class="sp-fill" id="spFill" style="width:0%"></div></div>
    </div>
  </div>

  <div class="actions">
    <button class="btn-fire" id="battleFireBtn" onclick="doBattleFire()">ğŸ”« &nbsp;FEUER!</button>
    <button class="btn-burst" id="battleBurstBtn" onclick="doBattleFire()" style="display:none;">âš¡ &nbsp;5 SCHUSS AUF EINMAL</button>
    <button class="btn-sec" onclick="endBattleEarly()">âœ• &nbsp;Alle SchÃ¼sse abgegeben â€“ Ergebnis eingeben</button>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ENTRY â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="screenEntry" class="screen">
  <div class="hdr">
    <div class="logo" style="font-size:1.7rem;letter-spacing:.14em;">ERGEBNIS <em>EINGEBEN</em></div>
    <div class="logo-tag">Dein Ergebnis vs. Bot-Ergebnis</div>
    <div class="hdr-tag" id="entryTag">â—† 10 METER Â· 40 SCHUSS â—†</div>
  </div>

  <div class="content">
    <!-- Bot Ergebnis -->
    <div class="bot-result fade-up">
      <div class="br-lbl">ğŸ¤– Bot â€“ Gesamtpunkte</div>
      <div class="dual-wrap">
        <div class="dual-col">
          <div class="br-pts" id="botFinalPts">0.0</div>
          <span class="ds-dec-lbl" style="color:rgba(240,130,110,.5);">Zehntel</span>
        </div>
        <div style="color:rgba(255,255,255,.15);font-size:1.4rem;font-weight:300;">|</div>
        <div class="dual-col">
          <div class="br-pts" id="botFinalInt" style="font-size:2rem;color:rgba(240,130,110,.55);">0</div>
          <span class="ds-dec-lbl" style="color:rgba(240,130,110,.35);">Ganze</span>
        </div>
      </div>
      <div class="br-sub" id="botFinalDetail">aus 40 Schuss Â· Ã˜ â€“</div>
    </div>

    <!-- Eingabe -->
    <div class="entry-card2 fade-up">
      <div class="ec-lbl">â—ˆ Dein Ergebnis eingeben (mit Zehntel, z.B. 284.7)</div>
      <div class="ec-row">
        <input type="number" class="score-inp" id="playerInp" placeholder="0.0" min="0" max="400" step="0.1" inputmode="decimal" enterkeyhint="done" autocomplete="off" oninput="onPlayerInput()">
        <button class="btn-calc" onclick="calcResult()">âš¡ VERGLEICH</button>
      </div>
      <div class="auto-int" id="autoInt">â†’ Ganze Punkte: <span id="autoIntVal">â€“</span></div>
    </div>

    <div class="divider">
      <div class="divider-line"></div>
      <div class="divider-txt">oder direkt wÃ¤hlen</div>
      <div class="divider-line"></div>
    </div>

    <!-- Quick buttons -->
    <div class="quick-pair">
      <button class="btn-win" onclick="quickResult('win')">
        <span class="qb-ico">ğŸ†</span>
        <span class="qb-main">GEWONNEN</span>
        <span class="qb-sub">Mein Score &gt; Bot</span>
      </button>
      <button class="btn-lose" onclick="quickResult('lose')">
        <span class="qb-ico">ğŸ˜”</span>
        <span class="qb-main">VERLOREN</span>
        <span class="qb-sub">Bot Score &gt; Meiner</span>
      </button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• GAME OVER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="screenOver" class="screen">
  <div class="go-emoji" id="goEmoji"></div>
  <div class="go-title" id="goTitle"></div>
  <div class="go-sub" id="goSub"></div>
  <div class="go-scores pop-in">
    <div class="gs-block">
      <div class="gs-who">ğŸ‘§ Du</div>
      <div class="gs-num you" id="goP">â€“</div>
      <div class="gs-unit" id="goPUnit" style="color:rgba(180,230,100,.4);">Zehntel</div>
      <div style="font-family:'DM Mono',monospace;font-size:1.2rem;color:rgba(180,230,100,.32);" id="goPInt">â€“</div>
      <div class="gs-unit" style="color:rgba(180,230,100,.22);">Ganze</div>
    </div>
    <div class="gs-sep">:</div>
    <div class="gs-block">
      <div class="gs-who">ğŸ¤– Bot</div>
      <div class="gs-num bot" id="goB">â€“</div>
      <div class="gs-unit" style="color:rgba(240,130,110,.4);">Zehntel</div>
      <div style="font-family:'DM Mono',monospace;font-size:1.2rem;color:rgba(240,130,110,.32);" id="goBInt">â€“</div>
      <div class="gs-unit" style="color:rgba(240,130,110,.22);">Ganze</div>
    </div>
  </div>
  <div class="go-reason" id="goReason"></div>
  <div class="go-margin" id="goMargin" style="display:none;"></div>
  <button class="btn-fire" style="max-width:320px;position:relative;z-index:1;" onclick="restartGame()">ğŸ”„ &nbsp;NOCHMAL</button>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SCRIPT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
/* â”€â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const G = {
  dist:'10', diff:'easy',
  weapon:'lg',          // 'lg' = Luftgewehr | 'kk' = KK
  shots:40,             // GewÃ¤hlte Schussanzahl (30/40/60)
  burst:false,          // 5er-Salve Modus
  botShots:[], botTotal:0, botTotalInt:0,
  shotsLeft:40, maxShots:40
};

/* â”€â”€â”€ CONFIG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const DIST_INFO = {
  lg:{
    '10':'<b>10 Meter</b> â€“ Luftgewehr-Standarddistanz. HÃ¶chste PrÃ¤zision gefordert.',
    '25':'<b>25 Meter</b> â€“ UngewÃ¶hnlich fÃ¼r LG. Mittlere Streuung.',
    '50':'<b>50 Meter</b> â€“ LG auf 50 m? Extremes Training. Viel Streuung!'
  },
  kk:{
    '10':'<b>10 Meter</b> â€“ Kurze Distanz mit KK. Sehr prÃ¤zise mÃ¶glich.',
    '25':'<b>25 Meter</b> â€“ Mittlere KK-Distanz. Gute Kontrolle nÃ¶tig.',
    '50':'<b>50 Meter</b> â€“ KK-Standarddistanz. Klassische KÃ¶nigsdisziplin!'
  }
};

const SIGMA = {'10':18,'25':30,'50':46};
const DIFF = {
  easy: { mult:0.88, noise:5,    lbl:'ğŸ˜Š KREISKLASSE',  cls:'easy',
          info:'<b>Kreisklasse</b> â€“ Solider Einstieg. ~310â€“340 Pkt. Schaffbar mit Konzentration!'},
  real: { mult:0.52, noise:2.5,  lbl:'ğŸ¯ BEZIRKSLIGA',  cls:'real',
          info:'<b>Bezirksliga</b> â€“ Fast nur 9er und 10er. ~355â€“375 Pkt. Kein Spaziergang!'},
  hard: { mult:0.30, noise:0.5,  lbl:'ğŸ’€ WM-NIVEAU',    cls:'hard',
          info:'<b>WM-Niveau</b> â€“ Trifft ~20Ã— den Innenzehner. ~390â€“403 Pkt. Kaum zu schlagen!'},
  elite:{ mult:0.18, noise:0.15, lbl:'ğŸ’« WELTREKORD',   cls:'elite',
          info:'<b>Weltrekord-Bot</b> â€“ Immer â‰¥400 Zehntel. Mathematisch fast perfekt. Viel GlÃ¼ck!'}
};

const WEAPON_CFG = {
  lg:{ icon:'ğŸŒ¬ï¸', name:'Luftgewehr', badgeCls:'lg', defaultDist:'10',
       onlyDist:true,   // LG ist fix auf 10 m
       setupTag:(dist)=>`â—† LUFTGEWEHR Â· ${dist} METER â—†` },
  kk:{ icon:'ğŸ¯', name:'KK',         badgeCls:'kk', defaultDist:'50',
       onlyDist:false,
       setupTag:(dist)=>`â—† KK Â· ${dist} METER â—†` }
};

/* â”€â”€â”€ DOM CACHE (performance: avoid repeated getElementById) â”€â”€â”€ */
const DOM = {};
function initDOMCache(){
  const ids = [
    'shotsLeft','botScoreChip','botScoreChipInt',
    'lsbDec','lsbInt','lsbProj',
    'spFill','spCount','battleTag','battleFireBtn','battleBurstBtn',
    'lastShotTxt','shotLog','muzzleFlash',
    'battleBadge','battleWeaponBadge',
    'distInfo','diffInfoTxt','setupTag','logoTag',
    'botFinalPts','botFinalInt','botFinalDetail',
    'playerInp','autoInt','autoIntVal','entryTag',
    'goP','goB','goPInt','goBInt','goPUnit','goTitle','goSub','goEmoji','goReason','goMargin',
    'wTabLG','wTabKK',
    'scFire','scN','scLbl',
    'burstBtn','burstBtnTxt','burstBadge'
  ];
  ids.forEach(id=>{ DOM[id] = document.getElementById(id); });
}

/* â”€â”€â”€ CANVAS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const canvas = document.getElementById('targetCanvas');
const ctx    = canvas.getContext('2d', {alpha:false}); // alpha:false = faster compositing

function setSz(){
  const vw = Math.min(window.innerWidth, 420);
  const sz = Math.min(vw - 36, 270);
  canvas.width = sz;
  canvas.height = sz;
}

/* Rings: [relR, fill, stroke, basePts, label] â€“ outer â†’ inner */
const RINGS=[
  [1.00,'#f0ece0','#c4bca4', 1,'WeiÃŸ'],
  [0.85,'#f0ece0','#b8b2a0', 2,'WeiÃŸ'],
  [0.70,'#1c1c1c','#383838', 3,'Schwarz'],
  [0.57,'#1c1c1c','#383838', 4,'Schwarz'],
  [0.45,'#1a4db0','#2268d8', 5,'Blau'],
  [0.35,'#1a4db0','#2268d8', 6,'Blau'],
  [0.26,'#c01818','#e83030', 7,'Rot'],
  [0.18,'#c01818','#e83030', 8,'Rot'],
  [0.11,'#cca018','#f0c030', 9,'Gold'],
  [0.05,'#cca018','#f0c030',10,'Bullseye']
];

function drawTarget(shots){
  const W=canvas.width,H=canvas.height,cx=W/2,cy=H/2,maxR=W/2-2;
  ctx.clearRect(0,0,W,H);

  /* base fill */
  const pg=ctx.createRadialGradient(cx-maxR*.3,cy-maxR*.3,0,cx,cy,maxR*1.1);
  pg.addColorStop(0,'#faf4e2');pg.addColorStop(1,'#e4dac0');
  ctx.beginPath();ctx.arc(cx,cy,maxR,0,Math.PI*2);ctx.fillStyle=pg;ctx.fill();

  /* edge shadow */
  const es=ctx.createRadialGradient(cx,cy,maxR*.75,cx,cy,maxR);
  es.addColorStop(0,'transparent');es.addColorStop(1,'rgba(60,40,10,.3)');
  ctx.beginPath();ctx.arc(cx,cy,maxR,0,Math.PI*2);ctx.fillStyle=es;ctx.fill();

  /* rings */
  for(const[relR,fill,stroke] of RINGS){
    const r=relR*maxR;
    ctx.beginPath();ctx.arc(cx,cy,r,0,Math.PI*2);
    ctx.fillStyle=fill;ctx.fill();
    ctx.strokeStyle=stroke;ctx.lineWidth=0.8;ctx.stroke();
  }

  /* Innenzehner (X-Ring) */
  const xR = RINGS[9][0] * maxR * 0.55;
  ctx.beginPath();ctx.arc(cx,cy,xR,0,Math.PI*2);
  ctx.strokeStyle='rgba(255,200,0,.55)';ctx.lineWidth=0.9;ctx.stroke();
  ctx.font=`600 ${maxR*.042}px Outfit,sans-serif`;
  ctx.fillStyle='rgba(255,200,0,.6)';ctx.textAlign='center';ctx.textBaseline='middle';
  ctx.fillText('X',cx+xR*.65,cy);

  /* ring numbers */
  const fs=maxR*.055;
  ctx.font=`600 ${fs}px Outfit,sans-serif`;
  ctx.textAlign='center';ctx.textBaseline='middle';
  const numColors=['#999','#999','#bbb','#bbb','#8ab','#8ab','#f99','#f99','#fc4'];
  [[0.925],[0.775],[0.635],[0.51],[0.40],[0.305],[0.22],[0.145],[0.08]].forEach(([rel],i)=>{
    const r=rel*maxR;
    ctx.fillStyle=numColors[i];
    ctx.fillText(RINGS[i][3],cx+r,cy);
    ctx.fillText(RINGS[i][3],cx-r,cy);
  });

  /* crosshairs */
  ctx.strokeStyle='rgba(0,0,0,.1)';ctx.lineWidth=0.6;ctx.setLineDash([2,5]);
  ctx.beginPath();ctx.moveTo(cx,cy-maxR);ctx.lineTo(cx,cy+maxR);ctx.stroke();
  ctx.beginPath();ctx.moveTo(cx-maxR,cy);ctx.lineTo(cx+maxR,cy);ctx.stroke();
  ctx.setLineDash([]);

  /* bullet holes */
  if(shots&&shots.length>0){
    for(const s of shots){
      drawHole(cx+s.dx,cy+s.dy,maxR*.044,'#a00c0c','#ff2828',s.cracks);
    }
  }

  /* outer ring border */
  ctx.beginPath();ctx.arc(cx,cy,maxR,0,Math.PI*2);
  ctx.strokeStyle='rgba(160,140,80,.5)';ctx.lineWidth=2;ctx.stroke();
}

function drawHole(x,y,r,dark,glow,cracks){
  const g=ctx.createRadialGradient(x,y,0,x,y,r*5);
  g.addColorStop(0,glow+'44');g.addColorStop(1,'transparent');
  ctx.beginPath();ctx.arc(x,y,r*5,0,Math.PI*2);ctx.fillStyle=g;ctx.fill();
  ctx.save();ctx.translate(x,y);ctx.strokeStyle='rgba(0,0,0,.2)';ctx.lineWidth=0.5;
  const crackData = cracks || Array.from({length:7},(_,i)=>({a:(i/7)*Math.PI*2,len:1.7}));
  for(const c of crackData){
    ctx.beginPath();ctx.moveTo(Math.cos(c.a)*r*.8,Math.sin(c.a)*r*.8);
    ctx.lineTo(Math.cos(c.a)*r*c.len,Math.sin(c.a)*r*c.len);ctx.stroke();
  }
  ctx.restore();
  const hg=ctx.createRadialGradient(x-r*.3,y-r*.3,0,x,y,r);
  hg.addColorStop(0,'#160a0a');hg.addColorStop(.6,'#040000');hg.addColorStop(1,dark);
  ctx.beginPath();ctx.arc(x,y,r,0,Math.PI*2);ctx.fillStyle=hg;ctx.fill();
  const rg=ctx.createRadialGradient(x-r*.3,y-r*.3,r*.5,x,y,r*1.4);
  rg.addColorStop(0,glow);rg.addColorStop(.5,dark);rg.addColorStop(1,'transparent');
  ctx.beginPath();ctx.arc(x,y,r*1.4,0,Math.PI*2);ctx.fillStyle=rg;ctx.globalAlpha=.5;ctx.fill();ctx.globalAlpha=1;
}

function gauss(s){
  const u=Math.max(1e-10,Math.random());
  return s*Math.sqrt(-2*Math.log(u))*Math.cos(2*Math.PI*Math.random());
}

/* â”€â”€â”€ SCORING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function scoreHit(dx,dy){
  const maxR = canvas.width/2-2;
  const d    = Math.sqrt(dx*dx+dy*dy);

  if(d > RINGS[0][0]*maxR) return {pts:0, label:'Daneben!', isX:false};

  let ringIdx = 0;
  for(let i=RINGS.length-1; i>=0; i--){
    if(d <= RINGS[i][0]*maxR){ ringIdx=i; break; }
  }

  const basePts = RINGS[ringIdx][3];
  const outerR  = RINGS[ringIdx][0] * maxR;
  const innerR  = ringIdx+1 < RINGS.length ? RINGS[ringIdx+1][0]*maxR : 0;
  const ringW   = outerR - innerR;
  const posInRing = ringW > 0 ? (outerR - d) / ringW : 1;

  const finalPts = Math.round(Math.min(10.9, basePts + posInRing * 0.9) * 10) / 10;

  const xR = RINGS[9][0] * maxR * 0.55;
  const isX = basePts === 10 && d <= xR;

  const label = isX ? 'âœ¦ Innenzehner (X)' : RINGS[ringIdx][4];
  return {pts: finalPts, label, isX};
}

function fmtPts(v){ return v.toFixed(1); }

/* â”€â”€â”€ WEAPON SWITCH â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function switchWeapon(w){
  if(G.weapon === w) return;
  G.weapon = w;

  DOM.wTabLG.classList.toggle('active', w==='lg');
  DOM.wTabKK.classList.toggle('active', w==='kk');

  const cfg = WEAPON_CFG[w];

  // Show/hide distance buttons based on weapon
  document.querySelectorAll('#distGroup .db').forEach(btn=>{
    if(cfg.onlyDist){
      // LG: only 10m visible
      btn.classList.toggle('hidden', btn.dataset.dist !== '10');
      btn.classList.toggle('active', btn.dataset.dist === '10');
    } else {
      btn.classList.remove('hidden');
    }
  });

  G.dist = cfg.defaultDist;
  // For KK, activate defaultDist button
  if(!cfg.onlyDist){
    document.querySelectorAll('#distGroup .db').forEach(b=>{
      b.classList.toggle('active', b.dataset.dist === cfg.defaultDist);
    });
  }

  DOM.distInfo.querySelector('.info-txt').innerHTML = DIST_INFO[w][G.dist];
  DOM.setupTag.textContent = cfg.setupTag(G.dist);
  DOM.diffInfoTxt.innerHTML = DIFF[G.diff].info;

  // Update streak corner for this weapon
  updateStreakCorner(w);
}

/* â”€â”€â”€ SELECTORS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function selDist(btn){
  if(WEAPON_CFG[G.weapon].onlyDist) return; // LG gesperrt auf 10 m
  document.querySelectorAll('#distGroup .db').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  G.dist = btn.dataset.dist;
  DOM.distInfo.querySelector('.info-txt').innerHTML = DIST_INFO[G.weapon][G.dist];
  DOM.setupTag.textContent = WEAPON_CFG[G.weapon].setupTag(G.dist);
}

function selDiff(btn){
  document.querySelectorAll('#diffGroup .dif').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  G.diff = btn.dataset.diff;
  DOM.diffInfoTxt.innerHTML = DIFF[G.diff].info;
}

function selShots(btn){
  document.querySelectorAll('#shotCountGroup .scb').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  G.shots = parseInt(btn.dataset.shots);
  // Update subtitle
  DOM.logoTag.textContent = `Du vs. Bot Â· ${G.shots} Schuss Â· Wer trifft besser?`;
}

function toggleBurst(){
  G.burst = !G.burst;
  DOM.burstBtn.classList.toggle('on', G.burst);
  DOM.burstBtnTxt.textContent = G.burst ? 'ğŸ”« 5er-Salve: AN' : 'ğŸ”« 5er-Salve: AUS';
  DOM.burstBadge.textContent  = G.burst ? 'AKTIV' : 'OPTIONAL';
}

/* â”€â”€â”€ STREAK (getrennt per Waffe) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Keys: sd_lg_streak / sd_kk_streak  etc.
   Streak-Corner zeigt immer die aktive Waffe
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€*/
// In-memory streak cache (avoid repeated localStorage reads)
const STREAK_CACHE = { lg:null, kk:null };

function todayStr(){
  const d=new Date();
  return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
}

function loadAllStreaks(){
  ['lg','kk'].forEach(w => loadStreakForWeapon(w));
  updateStreakCorner(G.weapon); // Show current weapon on startup
}

function loadStreakForWeapon(w){
  try{
    const prefix = `sd_${w}_`;
    const last   = localStorage.getItem(prefix+'last_day') || '';
    let streak   = parseInt(localStorage.getItem(prefix+'streak') || '0');
    const best   = parseInt(localStorage.getItem(prefix+'best')   || '0');
    const today  = todayStr();
    let isNew = false;

    if(last === ''){
      streak = 1; isNew = true;
    } else {
      const diffDays = Math.round((new Date(today) - new Date(last)) / 86400000);
      if(diffDays === 0){}
      else if(diffDays === 1){ streak++; isNew = true; }
      else { streak = 1; isNew = true; }
    }

    if(isNew) localStorage.setItem(prefix+'last_day', today);
    localStorage.setItem(prefix+'streak', streak);
    const nb = Math.max(streak, best);
    localStorage.setItem(prefix+'best', nb);

    STREAK_CACHE[w] = { streak, best:nb, isNew };
  } catch(e){
    STREAK_CACHE[w] = { streak:1, best:1, isNew:false };
  }
}

function updateStreakCorner(w){
  const data = STREAK_CACHE[w];
  if(!data) return;
  const { streak } = data;
  const wName = WEAPON_CFG[w].name;
  DOM.scFire.textContent = streak >= 30 ? 'ğŸ”¥ğŸ”¥ğŸ”¥' : streak >= 14 ? 'ğŸ”¥ğŸ”¥' : 'ğŸ”¥';
  DOM.scN.textContent    = streak;
  DOM.scLbl.textContent  = wName + ' Streak';
}

/* â”€â”€â”€ GAME FLOW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function startBattle(){
  G.maxShots  = G.shots;
  G.shotsLeft = G.shots;
  G.botShots = []; G.botTotal = 0; G.botTotalInt = 0;
  setSz(); drawTarget([]);
  DOM.shotLog.innerHTML = '';
  DOM.lastShotTxt.innerHTML = '<b>Bereit!</b> DrÃ¼ck FEUER â€“ du schieÃŸt in der echten Welt, der Bot virtuell.';

  const dc  = DIFF[G.diff];
  const cfg = WEAPON_CFG[G.weapon];

  DOM.battleBadge.textContent = dc.lbl;
  DOM.battleBadge.className   = 'diff-badge ' + dc.cls;

  DOM.battleWeaponBadge.textContent = cfg.icon + ' ' + cfg.name.toUpperCase();
  DOM.battleWeaponBadge.className   = 'weapon-badge ' + cfg.badgeCls;

  DOM.entryTag.textContent = `â—† ${G.dist} METER Â· ${cfg.name.toUpperCase()} Â· ${G.maxShots} SCHUSS â—†`;

  // Burst mode button visibility
  if(G.burst){
    DOM.battleFireBtn.style.display  = 'none';
    DOM.battleBurstBtn.style.display = '';
    DOM.battleBurstBtn.disabled      = false;
  } else {
    DOM.battleFireBtn.style.display  = '';
    DOM.battleBurstBtn.style.display = 'none';
  }

  updateBattleUI();
  showScreen('screenBattle');
}

function updateBattleUI(){
  const lowThresh = Math.max(5, Math.round(G.maxShots * 0.2)); // 20% of shots = "low"
  const low   = G.shotsLeft <= lowThresh;
  const fired = G.maxShots - G.shotsLeft;

  DOM.shotsLeft.textContent      = G.shotsLeft;
  DOM.shotsLeft.className        = 'chip-val' + (low ? ' low' : '');
  DOM.botScoreChip.textContent   = fmtPts(G.botTotal);
  DOM.botScoreChipInt.textContent= G.botTotalInt;

  DOM.lsbDec.textContent = fmtPts(G.botTotal);
  DOM.lsbInt.textContent = G.botTotalInt;

  if(fired > 0){
    const proj = Math.round((G.botTotal / fired) * G.maxShots * 10) / 10;
    DOM.lsbProj.textContent = '~' + fmtPts(proj);
  } else {
    DOM.lsbProj.textContent = 'â€“';
  }

  const pct = (fired / G.maxShots) * 100;
  DOM.spFill.style.width   = pct + '%';
  DOM.spFill.className     = 'sp-fill' + (low ? ' low' : '');

  DOM.spCount.textContent  = fired + ' / ' + G.maxShots + ' Schuss';
  DOM.spCount.className    = 'sp-count' + (low ? ' low' : '');

  const allDone = fired >= G.maxShots;
  DOM.battleTag.textContent = allDone
    ? `â—† ${G.maxShots} SCHUSS ABGEFEUERT â—†`
    : `â—† SCHUSS ${fired + 1} / ${G.maxShots} â—†`;

  // Disable correct button
  if(G.burst){
    DOM.battleBurstBtn.disabled = G.shotsLeft <= 0;
  } else {
    DOM.battleFireBtn.disabled  = G.shotsLeft <= 0;
  }
}

function fireSingleShot(){
  if(G.shotsLeft <= 0) return;

  const dc     = DIFF[G.diff];
  const sig    = SIGMA[G.dist];
  const botSig = sig * dc.mult + dc.noise * Math.random();
  const bdx    = gauss(botSig), bdy = gauss(botSig);
  const bRes   = scoreHit(bdx, bdy);

  G.botShots.push({
    dx:bdx, dy:bdy, pts:bRes.pts, label:bRes.label, isX:bRes.isX,
    cracks: Array.from({length:7}, (_,i) => ({
      a: (i/7)*Math.PI*2 + Math.random()*0.7,
      len: 1.4 + Math.random()
    }))
  });
  G.botTotal     = Math.round((G.botTotal + bRes.pts) * 10) / 10;
  G.botTotalInt += Math.floor(bRes.pts);
  G.shotsLeft--;
  return bRes;
}

function doBattleFire(){
  if(G.shotsLeft <= 0) return;

  const count = G.burst ? Math.min(5, G.shotsLeft) : 1;

  // Fire all shots, collect results
  const results = [];
  for(let i = 0; i < count; i++) results.push(fireSingleShot());

  // FX
  const f = DOM.muzzleFlash;
  f.style.transition = 'none'; f.style.opacity = '1';
  setTimeout(()=>{ f.style.transition = 'opacity .22s'; f.style.opacity = '0'; }, 55);
  document.body.classList.remove('shaking');
  void document.body.offsetWidth;
  document.body.classList.add('shaking');
  setTimeout(()=>document.body.classList.remove('shaking'), 320);

  // Shot log pills
  results.forEach(bRes => {
    const pill    = document.createElement('span');
    const pillCls = bRes.isX ? 'x' : bRes.pts >= 9 ? 'hi' : bRes.pts >= 6 ? 'mid' : bRes.pts >= 1 ? 'lo' : 'miss';
    pill.className   = 'sl-pill ' + pillCls;
    pill.textContent = bRes.isX ? `âœ¦${fmtPts(bRes.pts)}` : fmtPts(bRes.pts);
    DOM.shotLog.appendChild(pill);
    while(DOM.shotLog.children.length > 8) DOM.shotLog.removeChild(DOM.shotLog.firstChild);
  });

  // Info text â€” for burst show summary, for single show detail
  if(count > 1){
    const sumPts  = results.reduce((a,r) => a + r.pts, 0);
    const xCount  = results.filter(r => r.isX).length;
    const xStr    = xCount > 0 ? ` Â· ${xCount}Ã— âœ¦X` : '';
    DOM.lastShotTxt.innerHTML =
      `âš¡ <b>5er-Salve</b>: +<b>${fmtPts(Math.round(sumPts*10)/10)}</b>${xStr} &nbsp;|&nbsp; Gesamt: <b>${fmtPts(G.botTotal)}</b> <span style="color:rgba(240,130,110,.45);font-size:.85em;">(${G.botTotalInt} ganze)</span>`;
  } else {
    const bRes  = results[0];
    const emoji = bRes.isX ? 'âœ¦' : bRes.pts>=9.5?'ğŸ”¥':bRes.pts>=8?'ğŸ’¥':bRes.pts>=6?'ğŸ¯':bRes.pts>=4?'ğŸ‘Œ':bRes.pts>=2?'ğŸ˜¬':'ğŸ˜…';
    const scoreDisp = bRes.isX
      ? `<b style="color:#ffd040;">${bRes.label} Â· ${fmtPts(bRes.pts)}</b>`
      : `<b>${bRes.label} Â· ${fmtPts(bRes.pts)}</b>`;
    DOM.lastShotTxt.innerHTML =
      `${emoji} ${scoreDisp} &nbsp;|&nbsp; Gesamt: <b>${fmtPts(G.botTotal)}</b> <span style="color:rgba(240,130,110,.45);font-size:.85em;">(${G.botTotalInt} ganze)</span>`;
  }

  setTimeout(()=>{
    drawTarget(G.botShots);
    updateBattleUI();
    if(G.shotsLeft <= 0){
      if(G.burst) DOM.battleBurstBtn.disabled = true;
      else        DOM.battleFireBtn.disabled  = true;
      DOM.battleTag.textContent  = `â—† ${G.maxShots} SCHUSS ABGEFEUERT â—†`;
      DOM.lastShotTxt.innerHTML  =
        `ğŸ Bot fertig! Gesamt: <b>${fmtPts(G.botTotal)} Punkte</b> aus ${G.maxShots} Schuss.`;
      setTimeout(()=>goToEntry(), 1300);
    }
  }, 160);
}

function endBattleEarly(){ goToEntry(); }

function goToEntry(){
  DOM.botFinalPts.textContent = fmtPts(G.botTotal);
  DOM.botFinalInt.textContent = G.botTotalInt;
  const avg    = G.botShots.length > 0 ? (G.botTotal / G.botShots.length).toFixed(1) : 'â€“';
  const xCount = G.botShots.filter(s=>s.isX).length;
  const xStr   = xCount > 0 ? ` Â· ${xCount}Ã— âœ¦X` : '';
  DOM.botFinalDetail.textContent = `aus ${G.botShots.length} Schuss Â· Ã˜ ${avg} Pkt${xStr}`;
  DOM.playerInp.value       = '';
  DOM.autoIntVal.textContent = 'â€“';
  DOM.autoInt.className      = 'auto-int';
  showScreen('screenEntry');
}
function onPlayerInput(){
  const raw = DOM.playerInp.value;
  const val = parseFloat(raw);
  if(!isNaN(val) && val >= 0){
    DOM.autoIntVal.textContent = Math.floor(val);
    DOM.autoInt.className      = 'auto-int active';
  } else {
    DOM.autoIntVal.textContent = 'â€“';
    DOM.autoInt.className      = 'auto-int';
  }
}

function calcResult(){
  const raw = DOM.playerInp.value;
  const val = parseFloat(raw);
  if(isNaN(val) || val < 0){ DOM.playerInp.focus(); return; }
  showGameOver(Math.round(val * 10) / 10, G.botTotal, null, Math.floor(val));
}

function quickResult(res){
  if(res === 'win') showGameOver(G.botTotal+0.1, G.botTotal, 'Schnellauswahl: Gewonnen', G.botTotalInt+1);
  else              showGameOver(Math.max(0, G.botTotal-0.1), G.botTotal, 'Schnellauswahl: Verloren', Math.max(0, G.botTotalInt-1));
}

function showGameOver(pp,bp,reason,ppInt){
  DOM.goP.textContent     = pp >= 0 ? fmtPts(pp) : 'â€“';
  DOM.goB.textContent     = fmtPts(bp);
  DOM.goPInt.textContent  = ppInt != null ? ppInt : (pp >= 0 ? Math.floor(pp) : 'â€“');
  DOM.goBInt.textContent  = G.botTotalInt;
  DOM.goPUnit.textContent = pp >= 0 ? 'Zehntel' : '';

  const dc     = DIFF[G.diff];
  const cfg    = WEAPON_CFG[G.weapon];
  const xCount = G.botShots.filter(s=>s.isX).length;
  const xStr   = xCount > 0 ? ` Â· Bot: ${xCount}Ã— âœ¦X` : '';
  DOM.goReason.textContent = reason ||
    `${G.dist} m Â· ${cfg.name} Â· ${dc.lbl.replace(/[^\w\sâœ¦]/gi,'').trim()} Â· ${G.maxShots} Schuss${xStr}`;

  const diff    = Math.round((pp - bp) * 10) / 10;
  const absDiff = Math.abs(diff);
  const isElite = G.diff === 'elite';

  if(pp > bp){
    DOM.goEmoji.textContent = isElite ? 'ğŸŒŸ' : 'ğŸ†';
    DOM.goTitle.textContent = 'DU GEWINNST!';
    DOM.goTitle.className   = 'go-title win';
    DOM.goSub.textContent   = isElite
      ? 'ğŸ¤¯ Weltrekord-Bot geschlagen! Absolut legendÃ¤r!'
      : 'ScharfschÃ¼tzin! Der Bot hatte keine Chance.';
    DOM.goMargin.textContent = `+${fmtPts(absDiff)} Punkte Vorsprung`;
    DOM.goMargin.className   = 'go-margin win';
    DOM.goMargin.style.display = '';
  } else if(bp > pp){
    DOM.goEmoji.textContent = isElite ? 'ğŸ’«' : 'ğŸ¤–';
    DOM.goTitle.textContent = 'BOT GEWINNT!';
    DOM.goTitle.className   = 'go-title lose';
    DOM.goSub.textContent   = isElite
      ? 'Weltrekord-Niveau â€“ kaum zu schlagen. Respekt fÃ¼rs Versuchen!'
      : 'Nicht aufgeben â€“ ruf zur Revanche!';
    DOM.goMargin.textContent = `âˆ’${fmtPts(absDiff)} Punkte RÃ¼ckstand`;
    DOM.goMargin.className   = 'go-margin lose';
    DOM.goMargin.style.display = '';
  } else {
    DOM.goEmoji.textContent = 'ğŸ–ï¸';
    DOM.goTitle.textContent = 'UNENTSCHIEDEN!';
    DOM.goTitle.className   = 'go-title draw';
    DOM.goSub.textContent   = isElite ? 'Weltrekord-Bot auf AugenhÃ¶he â€“ bist du ein Roboter?!' : 'Was fÃ¼r ein ausgeglichenes Duell!';
    DOM.goMargin.textContent = 'Punktgleich!';
    DOM.goMargin.className   = 'go-margin draw';
    DOM.goMargin.style.display = '';
  }
  showScreen('screenOver');
}

function restartGame(){
  G.botShots = []; G.botTotal = 0; G.botTotalInt = 0;
  G.shotsLeft = G.shots; G.maxShots = G.shots;

  G.diff = 'easy';
  document.querySelectorAll('#diffGroup .dif').forEach(b=>b.classList.remove('active'));
  document.querySelector('[data-diff="easy"]').classList.add('active');
  DOM.diffInfoTxt.innerHTML = DIFF['easy'].info;

  const cfg = WEAPON_CFG[G.weapon];
  G.dist = cfg.defaultDist;
  document.querySelectorAll('#distGroup .db').forEach(b=>{
    if(cfg.onlyDist){
      b.classList.toggle('hidden', b.dataset.dist !== '10');
      b.classList.toggle('active', b.dataset.dist === '10');
    } else {
      b.classList.remove('hidden');
      b.classList.toggle('active', b.dataset.dist === cfg.defaultDist);
    }
  });
  DOM.distInfo.querySelector('.info-txt').innerHTML = DIST_INFO[G.weapon][G.dist];
  DOM.setupTag.textContent = cfg.setupTag(G.dist);

  setSz(); drawTarget([]);
  showScreen('screenSetup');
}

function showScreen(id){
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

/* â”€â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
initDOMCache();
setSz();
drawTarget([]);

// LG ist Standard â†’ 25m/50m ausblenden
document.querySelectorAll('#distGroup .db').forEach(b=>{
  if(b.dataset.dist !== '10') b.classList.add('hidden');
});

loadAllStreaks();

let _rzTimer = null;
window.addEventListener('resize', ()=>{
  if(_rzTimer) cancelAnimationFrame(_rzTimer);
  _rzTimer = requestAnimationFrame(()=>{ setSz(); drawTarget(G.botShots); });
}, { passive: true });
</script>
</body>
</html>
